<div class="my-16 flex flex-col md:mx-14 ">
    @if (gridcols() < 3) {
        <div class="text-start mt-36 self-start -translate-x-[40%]  fixed -rotate-90">
            <button class="text-white bg-[#8B5E35]  focus:ring-0 focus:border-0 font-medium rounded-lg text-sm px-5 py-1  focus:outline-none gap-2 flex items-center" type="button" data-drawer-target="drawer-navigation" data-drawer-show="drawer-navigation" aria-controls="drawer-navigation">
                <i class="fa-solid fa-sliders text-xl"></i><span class="capitalize text-xl ">filters</span>
            </button>
        </div>
        }
    <div>
        <h3 class="sec-head capitalize mb-2 mx-auto">category</h3>
        <h3 class="sec-head1 capitalize mb-4  mx-auto">navigate between products!</h3>
        
    </div>

    <div class="flex flex-row bg-[#EEEEEE] rounded-full capitalize mx-auto text-center self-center py-2 px-4 font-medium  text-[#9D9DAA]">
        <a class="py-1.5 px-3 sm:px-5 text-lg cursor-pointer rounded-full  " [ngClass]="{'bg-[#8B5E35] text-white': activeCategorySwap() === 'All'}" (click)="productsCategorySwap('All')">all</a>
        <a class="py-1.5 px-3 sm:px-5 text-lg cursor-pointer rounded-full  " [ngClass]="{'bg-[#8B5E35] text-white': activeCategorySwap() === 'Men'}" (click)="productsCategorySwap('Men')">men</a>
        <a class="py-1.5 px-3 sm:px-5 text-lg cursor-pointer rounded-full  " [ngClass]="{'bg-[#8B5E35] text-white': activeCategorySwap() === 'Women'}" (click)="productsCategorySwap('Women')">women</a>
        <a class="py-1.5 px-3 sm:px-5 text-lg cursor-pointer rounded-full  " [ngClass]="{'bg-[#8B5E35] text-white': activeCategorySwap() === 'Electronic'}" (click)="productsCategorySwap('Electronic')">electronics</a>
    </div>
    <div class="grid grid-cols-4 gap-2">
        <div class="col-span-1 flex flex-col text-start">
            @if (gridcols() >= 3) {
                <div class="mt-8 p-4 rounded-xl bg-white border border-[#8b5f3556]">
                    <span class="main-txt text-xl capitalize font-semibold">filter by</span>
                <div class="py-4 overflow-y-auto">
                    <ul class="space-y-2 font-medium">
                        <li>
                                <button (click)="toggleButton(1)" type="button" class="flex items-center w-full font-semibold text-lg  p-2 ps-0 main-txt  transition duration-75 rounded-lg group " aria-controls="dropdown-1" data-collapse-toggle="dropdown-1">
                                    <span class="flex-1 text-lg  text-left rtl:text-right whitespace-nowrap capitalize">category</span>
                                    <i [ngClass]="{'rotate-180': buttonClick() === true }" class="transition-all duration-300 ease-in-out fa-solid fa-angle-down main-color text-xl" ></i>
                            </button>
                            <ul id="dropdown-1" class="hidden py-2 space-y-2 sec-txt">
                                    <li>
                                        <a class=" text-lg cursor-pointer rounded-full  " [ngClass]="{'main-color': activeCategorySwap() === 'All'}" (click)="productsCategorySwap('All')">all</a>
                                    </li>
                                    <li>
                                        <a class=" text-lg cursor-pointer rounded-full  "[ngClass]="{'main-color': activeCategorySwap() === 'Men'}"  (click)="productsCategorySwap('Men')">men</a>
                                    </li>
                                    <li>
                                        <a class=" text-lg cursor-pointer rounded-full  " [ngClass]="{'main-color': activeCategorySwap() === 'Women'}" (click)="productsCategorySwap('Women')">women</a>
                                    </li>
                                    <li>
                                        <a class=" text-lg cursor-pointer rounded-full  " [ngClass]="{'main-color': activeCategorySwap() === 'Electronic'}" (click)="productsCategorySwap('Electronic')">electronics</a>
                                    </li>
                            </ul>
                        </li>
                        <li>
                                <button (click)="toggleButton()" type="button" class="flex items-center w-full font-semibold text-lg  p-2 ps-0 main-txt  transition duration-75 rounded-lg group " aria-controls="dropdown-2" data-collapse-toggle="dropdown-2">
                                    <span class="flex-1 text-lg  text-left rtl:text-right whitespace-nowrap capitalize">price <span class="sec-txt">(EGP)</span></span>
                                    <i  [ngClass]="{'rotate-180': buttonClick2() === true }" class="transition-all duration-300 ease-in-out fa-solid fa-angle-down main-color text-xl"></i>
                                </button>
                                <ul id="dropdown-2" class="hidden py-2 space-y-2 sec-txt">
                                    <li class="capitalize font-medium main-txt justify-between items-center flex">
                                        from<input min="149" max="6000" #minPrice (input)="updateValue(minPrice.valueAsNumber , maxPrice.valueAsNumber)" class="ms-2 w-[70%] rounded-2xl border-[#8B5E35] focus:ring-0 focus:border-[#8B5E35] " name="minPrice" type="number">
                                    </li>
                                    <li class="capitalize font-medium main-txt justify-between items-center flex">
                                        to<input min="149" max="6000" #maxPrice (input)="updateValue(minPrice.valueAsNumber ,maxPrice.valueAsNumber)" class="ms-2 w-[70%] rounded-2xl border-[#8B5E35] focus:ring-0 focus:border-[#8B5E35]"  name="maxPrice" type="number">
                                    </li>
                                </ul>
                        </li>
                    </ul>
                </div>
                </div>
            }@else{
            <div id="drawer-navigation" class="fixed z-50 top-0 left-0  h-screen p-4 overflow-y-auto transition-transform -translate-x-full bg-white w-64 " tabindex="-1" aria-labelledby="drawer-navigation-label">
                <span class="main-txt text-xl capitalize font-semibold">filter by</span>
                <button type="button" data-drawer-hide="drawer-navigation" aria-controls="drawer-navigation" class="bg-transparent rounded-lg text-sm w-8 h-8 absolute top-2.5 end-2.5 inline-flex items-center justify-center " >
                    <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                    </svg>
                    <span class="sr-only">Close menu</span>
                </button>
                <div class="py-4 overflow-y-auto">
                    <ul class="space-y-2 font-medium">
                        <li>
                                <button type="button" class="flex items-center w-full font-semibold text-lg  p-2 ps-0 main-txt  transition duration-75 rounded-lg group " aria-controls="dropdown-1" data-collapse-toggle="dropdown-1">
                                    <span class="flex-1 text-lg  text-left rtl:text-right whitespace-nowrap capitalize">category</span>
                                    <i class="fa-solid fa-angle-down main-color text-xl"></i>
                            </button>
                            <ul id="dropdown-1" class="hidden py-2 space-y-2 sec-txt">
                                <li>
                                    <a class=" text-lg cursor-pointer rounded-full  " [ngClass]="{' main-color': activeCategorySwap() === 'All'}" (click)="productsCategorySwap('All')">all</a>
                                </li>
                                <li>
                                    <a class=" text-lg cursor-pointer rounded-full  "[ngClass]="{'main-color': activeCategorySwap() === 'Men'}"  (click)="productsCategorySwap('Men')">men</a>
                                </li>
                                <li>
                                    <a class=" text-lg cursor-pointer rounded-full  " [ngClass]="{'main-color': activeCategorySwap() === 'Women'}" (click)="productsCategorySwap('Women')">women</a>
                                </li>
                                <li>
                                    <a class=" text-lg cursor-pointer rounded-full  " [ngClass]="{'main-color': activeCategorySwap() === 'Electronic'}" (click)="productsCategorySwap('Electronic')">electronics</a>
                                </li>
                            </ul>
                        </li>
                        <li>
                                <button type="button" class="flex items-center w-full font-semibold text-lg  p-2 ps-0 main-txt  transition duration-75 rounded-lg group " aria-controls="dropdown-2" data-collapse-toggle="dropdown-2">
                                    <span class="flex-1 text-lg  text-left rtl:text-right whitespace-nowrap capitalize">price <span class="sec-txt">(EGP)</span></span>
                                    <i class="fa-solid fa-angle-down main-color text-xl"></i>
                                </button>
                                <ul id="dropdown-2" class="hidden py-2 space-y-2 sec-txt">
                                    <li class="capitalize font-medium main-txt justify-between items-center flex">
                                        from<input min="149" max="6000" #minPrice (input)="updateValue(minPrice.valueAsNumber , maxPrice.valueAsNumber)" class="ms-2 w-[70%] rounded-2xl border-[#8B5E35] focus:ring-0 focus:border-[#8B5E35] " name="minPrice" type="number">
                                    </li>
                                    <li class="capitalize font-medium main-txt justify-between items-center flex">
                                        to<input min="149" max="6000" #maxPrice (input)="updateValue(minPrice.valueAsNumber ,maxPrice.valueAsNumber)" class="ms-2 w-[70%] rounded-2xl border-[#8B5E35] focus:ring-0 focus:border-[#8B5E35]"  name="maxPrice" type="number">
                                    </li>
                                </ul>
                        </li>
                    </ul>
                </div>
            </div>
            }
        </div>
        <div class="mx-auto md:col-span-3 col-span-full flex flex-col items-start">
            <div class="flex flex-row gap-5 items-center">
                <h3 class="font-semibold text-[#151411] text-[40px]  ms-3 mt-5  capitalize">{{activeCategorySwap()}}</h3>
                <span class="main-color text-lg mt-5 font-medium">({{productDisplayMini().length}})</span>
            </div>
            <div class="grid sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-4 mt-6">
                @for (prod of paginatedProducts(); track prod.id) {
                    <div class="col-span-1 scale-90 mx-auto card max-w-[275px] border-gray-200 rounded-xl shadow-lg shadow-[#c9996c] bg-white">
                        <div class="rounded-xl overflow-hidden relative">
                            @for (prodWish of userWishlist(); track prodWish._id) {
                                @if (prodWish._id === prod.id) {
                                  @if (wishCondition()[prod.id]) {
                                    <span class="loader border-t-[#8B5E35!important]  text-start w-6 h-6 top-0 right-0  absolute me-2 mt-2 ms-2 rounded-full py-1 px-2 bg-slate-100"></span>
                                  } @else {
                                    <span
                                      class="text-start top-0 right-0 absolute me-2 mt-2 text-lg font-medium ms-2 border-2 pt-2 border-[#8B5E35] rounded-full py-1 px-2 bg-slate-100 main-color z-10 cursor-pointer hover:scale-110 transition-all ease-in-out duration-500">
                                      <i (click)="removeFromWishlist(prod.id)" class="fa-solid fa-heart text-2xl"></i>
                                    </span>
                                  }
                                }
                              }
                      
                              @if (!isInWishlist(prod.id)) {
                                @if (wishCondition()[prod.id]) {
                                  <span class="loader border-t-[#8B5E35!important]   text-start w-6 h-6 top-0 right-0 absolute me-2 mt-2 ms-2 rounded-full py-1 px-2 bg-slate-100"></span>
                                } @else {
                                  <span
                                    class="text-start border-2 pt-2 border-[#8B5E35] top-0 right-0 absolute me-2 mt-2 text-lg font-medium ms-2 rounded-full py-1 px-2 bg-slate-100 main-color z-10 cursor-pointer hover:scale-110 transition-all ease-in-out duration-500">
                                    <i (click)="addToWishlist(prod.id)" class="fa-regular fa-heart text-2xl"></i>
                                  </span>
                                }
                              }
                            <img [routerLink]="['/details', prod.id]" 
                                    class="h-[275px] w-[275px] hover:scale-110 transition-all duration-500 ease-in-out cursor-pointer p-2 rounded-lg object-cover" 
                                    [src]="prod.imageCover" [alt]="prod.title" />
                                    <span class="text-start me-auto bottom-0 left-0 absolute text-lg font-medium  rounded-md ms-2 py-1 px-2 text-white main-color-bg z-10">-50%</span>
                        </div>
                        <div class="ps-2 px-5 pb-5">
                            <h5 class="text-start text-2xl font-medium tracking-tight main-txt">{{ prod.title.split(" ", 2).join(" ") }}</h5>
                            <div class="flex items-center justify-between text-white">
                                <div class="flex flex-col text-lg font-semibold">
                                    <span class="main-color ">{{prod.price | currency: 'EGP'}}  </span>
                                    <span class="text-gray-300 line-through"> {{prod.price * 2 | currency: 'EGP'}} </span>
                                </div>
                                <a role="button" (click)="addProductToCart(prod.id)" 
                                    class="relative main-color-bg px-1.5 py-1 rounded-lg hover:text-[#8B5E35] transition-all ease-in-out duration-500 hover:scale-110 border border-[#8B5E35] hover:bg-white">
                                    <i class="fa-solid fa-plus w-[20px] h-[20px]"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                }
            </div>

            <div class="flex justify-center items-center gap-4 mt-8 self-center" >
                <button (click)="previousPage()" 
                        [disabled]="currentPage() === 1" 
                        class="px-4 py-2 bg-[#8B5E35] text-white rounded-lg  transition-all duration-500 ease-in-out border border-[#8B5E35] hover:text-[#8B5E35] hover:bg-white"><i class="fa-solid fa-angle-left text-xl pt-1"></i></button>
                
                <span class="font-medium text-lg">Page {{currentPage()}} of {{totalPages}}</span>

                <button (click)="nextPage()" 
                        [disabled]="currentPage() >= totalPages" 
                        class="px-4 py-2 bg-[#8B5E35] text-white rounded-lg transition-all duration-500 ease-in-out border border-[#8B5E35] hover:text-[#8B5E35] hover:bg-white"><i class="fa-solid fa-angle-right text-xl pt-1"></i></button>
            </div>
        </div>
    </div>

</div>
